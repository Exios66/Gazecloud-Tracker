<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
    <meta http-equiv="Permissions-Policy" content="interest-cohort=()">
    <title>Eye Tracking Recorder & Analysis Dashboard</title>
    
    <!-- Styles -->
    <link rel="stylesheet" href="css/styles.css">
    
    <!-- External Dependencies -->
    <script src="https://api.gazerecorder.com/GazeCloudAPI.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.0/chart.min.js" 
            integrity="sha512-TK03gH1Gm//td4nG9lGFuIxFWBViON6gWlBe1K+DGdO0T48V1XJXDzcK0pAcn0OvykthLJf8pnwU4YHqCZMZw==" 
            crossorigin="anonymous" 
            referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js" 
            integrity="sha512-rKFvwjvE4liWPlFnvH4ZhRDfNZ9FOpdkD/BU5gAIA3VS3vOQrQ5BjKgbO3kxebKhHdHcNUHLqxQYSoxee9UwgA==" 
            crossorigin="anonymous" 
            referrerpolicy="no-referrer"></script>
    
    <!-- Application Scripts -->
    <script src="js/gazetracker.js" defer></script>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Eye Tracking Recorder & Analysis Dashboard</h1>
        </div>

        <div class="controls">
            <button type="button" onclick="startTracking()">Start Tracking</button>
            <button type="button" onclick="stopTracking()" disabled>Stop Tracking</button>
            <button type="button" onclick="exportCSV()" disabled>Export Data</button>
            <button type="button" onclick="clearData()" disabled>Clear Data</button>
        </div>

        <div id="liveData">
            <em>Live gaze data will appear here...</em>
        </div>

        <div id="debugLog"></div>

        <div class="chart-container">
            <canvas id="eyeMovementChart"></canvas>
        </div>

        <div class="chart-container">
            <canvas id="pupilDilationChart"></canvas>
        </div>

        <div class="chart-container">
            <canvas id="headMovementChart"></canvas>
        </div>

        <div class="sessions-container">
            <h2>Recorded Sessions</h2>
            <div id="sessionsList"></div>
        </div>
    </div>

    <script>
        // Check for HTTPS
        if (window.location.protocol !== 'https:' && window.location.hostname !== 'localhost') {
            window.location.href = 'https:' + window.location.href.substring(window.location.protocol.length);
        }
    </script>
</body>
</html>
